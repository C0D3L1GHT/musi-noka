<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bouncing Balls</title>
    <style>
        body {
            background-color: #1a1a1a;
            margin: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: 'Inter', sans-serif;
            color: #fff;
        }
        canvas {
            background-color: #2a2a2a;
            border: 2px solid #fff;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
            border-radius: 10px;
        }
        #message-box {
            position: absolute;
            background-color: rgba(0, 0, 0, 0.8);
            color: #fff;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            display: block;
            z-index: 100;
            border: 2px solid #fff;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.4);
            font-size: 1.2rem;
            max-width: 80%;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <canvas id="bouncingCanvas"></canvas>
    <div id="message-box">Click to Start</div>

    <script>
        // Get the canvas element and its 2D rendering context
        const canvas = document.getElementById('bouncingCanvas');
        const ctx = canvas.getContext('2d');
        const messageBox = document.getElementById('message-box');
        
        let gameActive = false;
        let animationFrameId = null;
        let balls = [];

        // Load the collision sound effect
        const collisionSound = new Audio('https://cdn.jsdelivr.net/gh/johannes-t-keller/sound-effects@main/audio/glass_002.ogg');
        collisionSound.volume = 0.5;

        // Function to play the sound effect
        function playCollisionSound() {
            if (collisionSound.paused) {
                collisionSound.play().catch(e => console.error("Audio play failed:", e));
            } else {
                const soundClone = collisionSound.cloneNode();
                soundClone.play().catch(e => console.error("Audio play failed:", e));
            }
        }

        // Set the canvas size to the window dimensions for a full-screen effect
        function resizeCanvas() {
            canvas.width = window.innerWidth * 0.8;
            canvas.height = window.innerHeight * 0.8;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // --- Ball Class ---
        class Ball {
            constructor(x, y, radius, color, speed) {
                this.x = x;
                this.y = y;
                this.radius = radius;
                this.color = color;
                const angle = Math.random() * 2 * Math.PI;
                this.vx = Math.cos(angle) * speed;
                this.vy = Math.sin(angle) * speed;
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.closePath();
                this.drawEyes();
            }

            drawEyes() {
                const eyeRadius = this.radius * 0.2;
                const pupilRadius = this.radius * 0.1;

                const eye1X = this.x - this.radius * 0.4;
                const eye2X = this.x + this.radius * 0.4;
                const eyeY = this.y;

                const eyeDirectionX = this.vx / Math.sqrt(this.vx * this.vx + this.vy * this.vy);
                const eyeDirectionY = this.vy / Math.sqrt(this.vx * this.vx + this.vy * this.vy);
                const pupilOffset = eyeRadius * 0.5;
                const pupil1X = eye1X + eyeDirectionX * pupilOffset;
                const pupil2X = eye2X + eyeDirectionX * pupilOffset;
                const pupilY = eyeY + eyeDirectionY * pupilOffset;
                
                ctx.beginPath();
                ctx.arc(eye1X, eyeY, eyeRadius, 0, Math.PI * 2);
                ctx.arc(eye2X, eyeY, eyeRadius, 0, Math.PI * 2);
                ctx.fillStyle = '#fff';
                ctx.fill();
                ctx.closePath();

                ctx.beginPath();
                ctx.arc(pupil1X, pupilY, pupilRadius, 0, Math.PI * 2);
                ctx.arc(pupil2X, pupilY, pupilRadius, 0, Math.PI * 2);
                ctx.fillStyle = '#000';
                ctx.fill();
                ctx.closePath();
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
            }

            checkWallCollision() {
                if (this.x - this.radius <= 0 || this.x + this.radius >= canvas.width) {
                    this.vx *= -1;
                    playCollisionSound();
                }
                if (this.y - this.radius <= 0 || this.y + this.radius >= canvas.height) {
                    this.vy *= -1;
                    playCollisionSound();
                }
            }

            checkBallCollision(otherBall) {
                const dx = otherBall.x - this.x;
                const dy = otherBall.y - this.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                const combinedRadius = this.radius + otherBall.radius;

                if (distance < combinedRadius) {
                    playCollisionSound();
                    const overlap = combinedRadius - distance;
                    const normalX = dx / distance;
                    const normalY = dy / distance;

                    this.x -= normalX * (overlap / 2);
                    this.y -= normalY * (overlap / 2);
                    otherBall.x += normalX * (overlap / 2);
                    otherBall.y += normalY * (overlap / 2);

                    this.vx *= -1;
                    this.vy *= -1;
                    otherBall.vx *= -1;
                    otherBall.vy *= -1;
                }
            }

            checkWallCollisionWithObject(wall) {
                let testX = this.x;
                let testY = this.y;

                if (this.x < wall.x) {
                    testX = wall.x;
                } else if (this.x > wall.x + wall.width) {
                    testX = wall.x + wall.width;
                }

                if (this.y < wall.y) {
                    testY = wall.y;
                } else if (this.y > wall.y + wall.height) {
                    testY = wall.y + wall.height;
                }

                let distX = this.x - testX;
                let distY = this.y - testY;
                let distance = Math.sqrt((distX * distX) + (distY * distY));

                if (distance <= this.radius) {
                    playCollisionSound();
                    const overlap = this.radius - distance;
                    const pushX = distX / distance;
                    const pushY = distY / distance;

                    this.x += pushX * overlap;
                    this.y += pushY * overlap;

                    if (Math.abs(distX) > Math.abs(distY)) {
                        this.vx *= -1;
                    } else {
                        this.vy *= -1;
                    }
                }
            }
        }

        // --- Game Initialization ---
        const numBalls = 6;
        const colors = ['#FF0000', '#0000FF', '#FFFFFF', '#000000', '#FFFF00', '#008000'];
        const initialSpeed = 1.5;

        // Default walls to start with
        let walls = [
            { x: 100, y: 100, width: 250, height: 20 },
            { x: 450, y: 100, width: 250, height: 20 },
            { x: 100, y: 100, width: 20, height: 250 },
            { x: 680, y: 100, width: 20, height: 250 },
            { x: 350, y: 100, width: 20, height: 200 },
            { x: 350, y: 300, width: 200, height: 20 },
            { x: 550, y: 300, width: 20, height: 200 },
            { x: 350, y: 500, width: 200, height: 20 },
            { x: 350, y: 500, width: 20, height: 200 },
            { x: 350, y: 680, width: 200, height: 20 }
        ];

        let goal = {
            x: 0,
            y: 0,
            width: 100,
            height: 100
        };
        
        function resetBalls() {
            balls = [];
            const radius = 15;
            const startX = 50;
            const startY = 50;
            for (let i = 0; i < numBalls; i++) {
                balls.push(new Ball(startX, startY, radius, colors[i % colors.length], initialSpeed));
            }
        }
        
        function setGoalPosition() {
            goal.x = canvas.width - 150;
            goal.y = canvas.height - 150;
        }

        // --- Game Loop ---
        function gameLoop() {
            if (!gameActive) {
                return;
            }
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            ctx.fillStyle = '#8c8c8c';
            walls.forEach(wall => {
                ctx.fillRect(wall.x, wall.y, wall.width, wall.height);
            });

            ctx.fillStyle = '#00aa00';
            ctx.fillRect(goal.x, goal.y, goal.width, goal.height);

            for (let i = 0; i < balls.length; i++) {
                const ball = balls[i];
                ball.update();
                ball.checkWallCollision();
                
                walls.forEach(wall => {
                    ball.checkWallCollisionWithObject(wall);
                });

                if (ball.x + ball.radius > goal.x &&
                    ball.x - ball.radius < goal.x + goal.width &&
                    ball.y + ball.radius > goal.y &&
                    ball.y - ball.radius < goal.y + goal.height) {
                    
                    gameActive = false;
                    messageBox.innerText = 'Game Over! A ball has reached the goal!';
                    messageBox.style.display = 'block';
                    return;
                }
            }

            for (let i = 0; i < balls.length; i++) {
                for (let j = i + 1; j < balls.length; j++) {
                    balls[i].checkBallCollision(balls[j]);
                }
            }

            for (let i = 0; i < balls.length; i++) {
                balls[i].draw();
            }

            animationFrameId = requestAnimationFrame(gameLoop);
        }

        // --- Event Listener to Start Game on Click ---
        canvas.addEventListener('click', startGame, { once: true });
        messageBox.addEventListener('click', startGame, { once: true });
        
        function startGame() {
            gameActive = true;
            messageBox.style.display = 'none';
            resetBalls();
            gameLoop();
        }

        // Initial setup
        window.onload = function() {
            setGoalPosition();
        };

    </script>
</body>
</html>

